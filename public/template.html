<?php

# формирование переменной таблицы
$table = '
<style>
    .container {
        width: 100%;
        height: 100%;
        overflow: auto;
    }
    table, tr, th, td {
        text-align: center;
        border: 1px solid black;
        border-collapse: collapse;
        padding: 5px;
    }
    table {
        width: 100%;
    }
    thead th {
        line-height: 25px;
        position: sticky;
        top: -2px;
    }
    .leftText{
        text-align: left;
    }
    .leftRight{
        text-align: right;
    }
    tr:hover{
        background: aqua;
    }
    th{
        text-transform: uppercase;
        background: #ededed;
        color: #555;
    }
    th a{
        color: #000fbc;
        text-decoration: none;
        padding: 5px 10px;
    }
    th span{
        color: #555;
        font-size: 1.1em;
    }
    p,center {
        margin: 0 auto;
        width: 200px;
    }
</style>
<div class="container">
    <h1>Home Task</h1>
    <table><thead><tr style="position: sticky;top: 0px;">
        <th><span>' . @$arrowId . '</span><a href="?sort=' . $descParam . 'id">id</a><span>' . @$arrowId . '</span></th>
        <th>user link</th>
        <th>comment</th>
        <th><span>' . @$arrowCategory . '</span><a href="?sort=' . $descParam . 'category">category</a><span>' . @$arrowCategory . '</span></th>
        <th><span>' . @$arrowTotalSpent . '</span><a href="?sort=' . $descParam . 'total_spent">total spent, usd</a><span>' . @$arrowTotalSpent . '</span></th>
        <th><span>' . @$arrowCreatedAt . '</span><a href="?sort=' . $descParam . 'created_at">created at</a><span>' . @$arrowCreatedAt . '</span></th>
    </tr></thead>';
        foreach ($arr as $row) {
        # форматирование значений перед записью в переменную таблицы
        $table .= '<tr>
            <td class="leftRight">' . $row['id'] . '</td>
            <td>' . $row['user_link'] . '</td>
            <td class="leftText" title="' . $row['comment'] . '">' . mb_strimwidth($row['comment'], 0, 100, "...") . '</td>
            <td>' . $row['category'] . '</td>
            <td>$ ' . $row['total_spent'] . '</td>
            <td>' . date('Y-m-d', $row['created_at']) . '</td>
        </tr></div>';
}

$table .= '<tr>
    <th><span>' . @$arrowId . '</span><a href="?sort=' . $descParam . 'id">id</a><span>' . @$arrowId . '</span></th>
    <th>user link</th>
    <th>comment</th>
    <th><span>' . @$arrowCategory . '</span><a href="?sort=' . $descParam . 'category">category</a><span>' . @$arrowCategory . '</span></th>
    <th><span>' . @$arrowTotalSpent . '</span><a href="?sort=' . $descParam . 'total_spent">total spent</a><span>' . @$arrowTotalSpent . '</span></th>
    <th><span>' . @$arrowCreatedAt . '</span><a href="?sort=' . $descParam . 'created_at">created at</a><span>' . @$arrowCreatedAt . '</span></th>
</tr></table>';
echo $table, '<p class="center">Array size: ' . sizeof($arr) . ' elements</p>'; // вывод таблицы